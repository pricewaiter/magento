functional_tests_v19php53:
  build: .
  dockerfile: ./docker/functional-tests/Dockerfile
  environment:
    MAGENTO_BASE_URL: 'http://magento:1955'
    PRICEWAITER_API_KEY: MAGENTO
    PRICEWAITER_SHARED_SECRET: SECRET
  links:
    - "v19php53:magento"

order_verifier:
    build: docker/order_verifier

order_verifier:
    build: docker/order_verifier

phpcs:
    build: .
    dockerfile: ./docker/phpcs/Dockerfile

v19php53:
  build:
    path: .
    dockerfile_path: ./docker/v1.9-php5.3/Dockerfile
  environment:
    - MAGENTO_DB_PASSWORD=password
    - MAGENTO_DB_USER=root
    # Use these variables to link into your PriceWaiter docker environment running locally.
    - PRICEWAITER_API_URL=http://dockerhost:8008
    - PRICEWAITER_ORDER_VERIFICATION_URL=http://order_verifier/1/order/verify
    - PRICEWAITER_RETAILER_URL=http://localhost:8009
    - PRICEWAITER_WIDGET_URL=http://dockerhost:8006
  extra_hosts:
    # Important: Tell tests how to find magento host internally.
    - "magento:127.0.0.1"
  links:
    - mysql
    - order_verifier
  ports:
    - "1955:1955"

mysql:
    image: mysql:5.6
    environment:
        - MYSQL_ROOT_PASSWORD=password
